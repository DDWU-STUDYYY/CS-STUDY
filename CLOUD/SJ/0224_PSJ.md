# IAM 기초

참고 강의 :

[쉽게 설명하는 AWS 기초 강좌 5: IAM 기초
](https://www.youtube.com/watch?v=lcly_aIq1KI&list=PLfth0bK2MgIan-SzGpHIbfnCnjj583K2m&index=6)

[쉽게 설명하는 AWS 기초 강좌 6: 가상화란?
](https://www.youtube.com/watch?v=hb_4Tf6bAtY&list=PLfth0bK2MgIan-SzGpHIbfnCnjj583K2m&index=7)

# IAM

> AWS Identity and Access Management(IAM)를 사용하면 AWS 서비스와 리소스에 대한 액세스를 안전하게 **관리**할 수 있습니다. 또한, AWS 사용자 및 그룹을 만들고 관리하며 AWS 리소스에 대한 액세스를 허용 및 거부할 수 있습니다.
>

## 역할

- AWS 어카운트 관리 및 리소스/사용자/서비스의 권한제어
    - 서비스 사용을 위한 인증 정보 부여
- 사용자의 생성 및 관리 계정의 보안
    - 사용자의 패스워드 정책 관리(일정 시간마다 패스워드 변경 등)
- 다른 계정과의 리소스 공유
    - Identity Federation(Facebook 로그인, 구글 로그인 등)
- 계정에 별명 부여 가능 → 로그인 주소 생성 가능

## 구성

### 사용자

- 실제 AWS를 사용하는 사람 혹은 어플리케이션을 의미

### 그룹

ex) 개발자, 디자이너 등등…

- 사용자의 집합
- 그룹에 속한 사용자는 그룹에 부여된 권한을 행사

### 정책

- 사용자와 그룹, 역할이 무엇을 할 수 있는지에 관한 문서
- JSON(JavaScript Object Notation) 형식으로 정의

### 역할

- AWS 리소스에 부여하여 AWS 리소스가 무엇을 할 수 있는지를 정의
- 혹은 다른 사용자가 역할을 부여 받아 사용
- 다른 자격에 대해서 신뢰관계를 구축가능
- 역할을 바꾸어가며 서비스를 사용 가능

정책은 사용자, 그룹, 역할에 부여될 수 있다.

## IAM 권한 검증

예시 1

ex) 사용자가 S3를 이용하고 싶을 경우

1. 이용할 수 있는 **정책**이 부여되었는지를 확인
2. 1이 실패하면 내가 속한 그룹에 **정책**이 부여되었는지 확인
3. 2가 실패하면 내게 위임된 **역할**에 이용할 수 있는 **정책**이 부여되었는지 확인
4. 3이 실패하면 **권한 없음**으로 판명

예시 2

ex) Lambda에서 S3를 이용하고 싶을 경우

1. Lambda가 부여 받은 **역할**이 S3를 이용할 수 있는 **정책**이 붙어있는 확인
2. 1이 실패하면 권한 없음으로 판명

## 사용자의 종류

- 루트 사용자: 결제 관리를 포함한 계정의 모든 권한을 가지고 있음
    - 관리 목적 이외에 다른 용도로 사용하지 않는 것을 권장
    - 탈취 되었을 때 복구가 매우 어려움 → MFA를 설정하는 것을 권장
    - MFA : 일회용 패스워드를 생성하여 로그인
- IAM 사용자 : IAM을 통해 생성해서 사용하는 사용자
    - 한 사람 혹은 하나의 어플리케이션을 의미
    - 설정 시 콘솔 로그인 권한 부여 가능
    - 설정 시 AWS 서비스를 이용할 수 있음
        - Access Key
        - Secret Access Key
    - AdminAccess를 부여하더라도 루트 사용자로 별도의 설정을 하지 않으면 **Billing 기능을 사용할 수 없음**

## IAM 자격 증명 보고서

- 계정의 모든 사용자와 암호, 액세스 키, MFA 장치 등의 증명 상태를 나열하는 보고서를 생성하고 다운로드 가능
- 4시간에 한번 씩 생성 가능
- AWS 콘솔, CLI, API에서 생성 요청 및 다운로드 가능
- 포함되는 정보

### 암호

- 암호의 활성화 여부
- 마지막으로 사용된 시간
- 마지막으로 변경된 시간
- 언제 변경되어야 하는지

### 액세스키

- 액세스키 활성화 여부
- 마지막으로 사용된 시간
- 마지막으로 변경된 시간
- 어떤 서비스에 마지막으로 사용되었는지

### 기타

- MFA 사용 여부
- 사용자 생성 시간

## IAM 모범 사용 사례

- 루트 사용자는 사용하지 않기
- 불필요한 사용자는 만들지 않기
- 가능하면 그룹과 정책을 사용하기
- 최소한의 권한만을 허용하는 습관을 들이기(Principle of least privilge
- MFA를 활성화 하기
- AccessKey 대신 역할을 활용하기
- IAM 자격 증명 보고서(Credential Report) 활용하기

---

# 가상화

## 가상화란?

- 단일 컴퓨터의 하드웨어 요소를 일반적으로 가상머신(VM)이라고 하는 다수의 가상 컴퓨터로 분할할 수 있도록 해주는 기술
- 리소스를 효율적으로 관리할 수 있다.
- 다수의 컴퓨터를 매니징하는데 효율적인 기술이다.

## 간단한 용어 설명

- 운영체제 : 시스템 하드웨어 자원과 소프트웨어 자원을 운영 관리하는 프로그램
    - Windows, Linux 등등
- 특권 명령(Privileged instruction) : 시스템 요소들과 소통할 수 있는 명령 - OS만 가능
    - OS는 특권명령때문에 하나의 하드웨어 시스템당 하나밖에 돌아갈 수없음
    - 일반 프로그램은 특권 명령이 필요 없기 때문에 많은 프로그램을 동시에 수행가능
- 가상화가 나타나기 전까지는 하나의 하드웨어 시스템은 하나의 OS만 실행이 가능했음
    - 즉 일반적인 컴퓨터처럼 직접 OS가 하드웨어에 설치된 상태(Bare-Metal)로만 운여 가능했었음

## 가상화의 역사

- 1세대 : 완전 가상화(Fully Emulated)
    - 모든 시스템 요소가 애뮬레이터 안에서 돌아감
    - 즉 CPU, 하드디스크, 마더보드 등 모든 요소를 애뮬레이터로 구현하여 OS와 연동
    - 엄청나게 느림
- 2세대 : Paravirtualizaion
    - Guest OS는 하이퍼바이저와 통신
    - 하이퍼바이저 : OS와 하드웨어 사이에 존재하는 일종의 가상화 매니저
    - 속도의 향상
    - 몇몇 요소의 경우 여전히 애뮬레이터 필요 == 느림
- 3세대 : Hardware Virtual Machine(HVM)
    - 하드웨어에서 직접 가상화를 지원
    - 직접 Guest-OS가 하드웨어와 통신 == 빠른 속도(near bare-metal)

## 가상화와 클라우드

- AWS 클라우드 환경에서 리소스를 작은 단위로 빠르게 구성할 수 있는 원동력은 가상화이다.
- 즉, AWS에서 사용자마다 컴퓨터를 할당해 주는 것이 아닌 이미 구축된 가상화 가능한 서버의 한 부분을 할당해주는 것
- AWS는 미리 구성되어있는 서버를 가상화시켜서 유저에게 할당하고 반납받는다.
- EC2는 가상화된 환경에서 동작하는 것이다.